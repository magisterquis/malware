package main

/*
 * cmdjoin.go
 * Join a new channel
 * By J. Stuart McMurray
 * Created 20160726
 * Last Modified 20160726
 */

import "strings"

/* join joins a new channel */
func init() {
	/* TODO: Randomify */
	RegisterCommand("join", &Command{
		Do: func(s *Server, replyto, args string) error {
			var (
				name string /* Channel name */
				key  string /* Channel key */
			)
			/* Split off channel and key */
			parts := strings.SplitN(args, string(' '), 2)
			if 0 == len(parts) {
				/* TODO: Randomify */
				return s.SendMsg(
					replyto,
					[]byte("No channel given"),
				)
			}
			name = parts[0]
			if 2 == len(parts) {
				key = parts[1]
			}
			/* Try to join the channel */
			return s.JoinOne(name, key)
		},
		/* TODO: Randomify */
		Help: "#channel [key]",
	})
}
